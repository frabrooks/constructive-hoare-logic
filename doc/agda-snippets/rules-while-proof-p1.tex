\begin{code}
  \>[2]\AgdaFunction{D3-While-Rule}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{P}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{C}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{PBCP}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{‚ä®P}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{‚Ñ±}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{‚åä·µóC\,·µó‚åã}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{go}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{‚Ñ±}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{‚ä®P}\AgdaSpace{}%
\AgdaBound{‚åä·µóC\,·µó‚åã}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{where}\<%
\\
%
\>[6]\AgdaComment{------------------------------------------------------------------------------------------------------------------------}\<%
\\
%
\>[6]\AgdaComment{-- Using mutually recursive functions go and go-true      }\<%
\\
%
\>[6]\AgdaFunction{go}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[633I]\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{‚Ñ±}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä®}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{‚åä·µóC\,·µó‚åã}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚åä·µó}}\AgdaSpace{}%
\AgdaBound{‚Ñ±}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚∏¥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{ùî¥ùî•ùî¶ùî©ùî¢}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{ùíπ‚Ñ¥}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{Õæ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚∏¥}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{·µó‚åã}}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[633I]%
\>[11]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Ä≥}\AgdaSpace{}%
\AgdaBound{‚åä·µóC\,·µó‚åã}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä®}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{op‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{op‚ÇÅ}\AgdaSpace{}%
\AgdaInductiveConstructor{¬¨‚Çí}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{\&\&‚Çí}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaComment{-- ‚Ñ± needs to be an argument by itself outside the Sigma type}\<%
\\
%
\>[6]\AgdaComment{-- so we can recurse on it as Agda can't see it always}\<%
\\
%
\>[6]\AgdaComment{-- decrements with each call if it is inside the product.}\<%
\\
%
\>[6]\AgdaComment{---------------------------------------------------------------------------------------------------------------------------}\<%
\\
%
\>[6]\AgdaComment{-- case where B is true}\<%
\\
%
\>[6]\AgdaFunction{go-true}%
\>[664I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{‚àÄ}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{‚Ñ±}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{v}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä®}}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{evalExp}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[664I]%
\>[14]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{toTruthValue}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{v}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{‚â°}}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{‚åä·µóC\,·µó‚åã}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚åä·µó}}\AgdaSpace{}%
\AgdaBound{‚Ñ±}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚∏¥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ùî±ùî•ùî¢ùî´}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{ùî¥ùî•ùî¶ùî©ùî¢}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{ùíπ‚Ñ¥}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{Õæ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚∏¥}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{·µó‚åã}}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{to-witness}\AgdaSpace{}%
\AgdaBound{‚åä·µóC\,·µó‚åã}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä®}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{op‚ÇÇ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{op‚ÇÅ}\AgdaSpace{}%
\AgdaInductiveConstructor{¬¨‚Çí}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{\&\&‚Çí}\AgdaSpace{}%
\AgdaBound{P}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{go-true}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{‚Ñ±}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{‚ä®P}\AgdaSpace{}%
\AgdaBound{p‚ÇÅ}\AgdaSpace{}%
\AgdaBound{p‚ÇÇ}\AgdaSpace{}%
\AgdaBound{‚åä·µóC\,·µó‚åã}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{‚åä·µó‚åã-split}\AgdaSpace{}%
\AgdaBound{‚Ñ±}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{ùî¥ùî•ùî¶ùî©ùî¢}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{ùíπ‚Ñ¥}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{Õæ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{‚åä·µóC\,·µó‚åã}\<%
\\
%
\>[6]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{L·µó}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{L·µó}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{‚Ñ±'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{‚Ñ±'}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{R·µó}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{R·µó}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{lt}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{Œî}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Œî}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Œõ}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[9]\AgdaKeyword{where}\<%
\\
%
\>[9]\AgdaFunction{‚ä®B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä®}}\AgdaSpace{}%
\AgdaBound{B}\<%
\\
%
\>[9]\AgdaFunction{‚ä®B}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaBound{p‚ÇÅ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSpace{}%
\AgdaFunction{T}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaBound{p‚ÇÇ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaFunction{‚ä®P\&B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä®}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{op‚ÇÇ}\AgdaSpace{}%
\AgdaBound{P}\AgdaSpace{}%
\AgdaInductiveConstructor{\&\&‚Çí}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaFunction{‚ä®P\&B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ConjunctionIntro}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{‚ä®P}\AgdaSpace{}%
\AgdaFunction{‚ä®B}\<%
\\
%
\>[9]\AgdaFunction{‚ä®P'}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Ä≥}\AgdaSpace{}%
\AgdaBound{L·µó}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚ä®}}\AgdaSpace{}%
\AgdaBound{P}\<%
\\
%
\>[9]\AgdaFunction{‚ä®P'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{PBCP}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaFunction{‚ä®P\&B}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{‚Ñ±}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{L·µó}\AgdaSymbol{)}\<%
\\
 \>[9]\AgdaComment{-- Proof of termination of rhs of split with ‚Ñ±'}\<%
\\
%
\>[9]\AgdaFunction{R·µó+}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚åä·µó}}\AgdaSpace{}%
\AgdaBound{‚Ñ±'}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{k}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚∏¥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{ùî¥ùî•ùî¶ùî©ùî¢}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{ùíπ‚Ñ¥}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{Õæ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚∏¥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Ä≥}\AgdaSpace{}%
\AgdaBound{L·µó}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{·µó‚åã}}\<%
\\
%
\>[9]\AgdaFunction{R·µó+}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{addFuel}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaInductiveConstructor{ùî¥ùî•ùî¶ùî©ùî¢}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{ùíπ‚Ñ¥}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{Õæ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{‚Ñ±'}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{k}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{R·µó}\<%
\\
 \>[9]\AgdaComment{-- ‚Ñ±' with (‚Ñ±' ‚â§ ‚Ñ±) implies termination with ‚Ñ± fuel}\<%
\\
%
\>[9]\AgdaFunction{R·µó‚Ñ±}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚åä·µó}}\AgdaSpace{}%
\AgdaBound{‚Ñ±}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚∏¥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{ùî¥ùî•ùî¶ùî©ùî¢}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{ùíπ‚Ñ¥}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{Õæ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚∏¥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Ä≥}\AgdaSpace{}%
\AgdaBound{L·µó}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{·µó‚åã}}\<%
\\
%
\>[9]\AgdaFunction{R·µó‚Ñ±}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[833I]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaBound{ùê∂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{ùî¥ùî•ùî¶ùî©ùî¢}}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{ùíπ‚Ñ¥}}\AgdaSpace{}%
\AgdaBound{C}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{Õæ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{in}\AgdaSpace{}%
\AgdaFunction{subst}\<%
\\
\>[.][@{}l@{}]\<[833I]%
\>[15]\AgdaSymbol{(Œª}\AgdaSpace{}%
\AgdaBound{‚Ñ±}\AgdaSpace{}%
\AgdaSymbol{‚Üí}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚åä·µó}}\AgdaSpace{}%
\AgdaBound{‚Ñ±}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚∏¥}}\AgdaSpace{}%
\AgdaBound{ùê∂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{‚∏¥}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{‚Ä≥}\AgdaSpace{}%
\AgdaBound{L·µó}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{·µó‚åã}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proof}\AgdaSpace{}%
\AgdaBound{lt}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{R·µó+}\<%
\end{code}