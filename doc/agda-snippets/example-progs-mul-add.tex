\begin{code}
\>[2]\AgdaComment{-- Multiply 𝑿 and 𝒀, and store in 𝒛}\<%
\\
%
\>[2]\AgdaComment{-- without using multiplication op.}\<%
\\
%
\>[2]\AgdaComment{-- ((11.4) in TSOP,Gries)}\<%
\\
%
\>[2]\AgdaFunction{add*}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{𝑿}\AgdaSpace{}%
\AgdaBound{𝒀}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Exp}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Program}\<%
\\
%
\>[2]\AgdaFunction{add*}%
\>[118I]\AgdaBound{𝑿}\AgdaSpace{}%
\AgdaBound{𝒀}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[.][@{}l@{}]\<[118I]%
\>[7]\AgdaFunction{𝒙}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{:=}}\AgdaSpace{}%
\AgdaBound{𝑿}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{;}}\<%
\\
%
\>[7]\AgdaFunction{𝒚}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{:=}}\AgdaSpace{}%
\AgdaBound{𝒀}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{;}}\<%
\\
%
\>[7]\AgdaFunction{𝒛}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{:=}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑐𝑜𝑛𝑠𝑡}\AgdaSpace{}%
\AgdaFunction{⓪}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{;}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{𝔴𝔥𝔦𝔩𝔢}}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{(}%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑣𝑎𝑙}\AgdaSpace{}%
\AgdaFunction{𝒚}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑐𝑜𝑛𝑠𝑡}\AgdaSpace{}%
\AgdaFunction{⓪}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{𝑒𝑣𝑒𝑛〈}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑣𝑎𝑙}\AgdaSpace{}%
\AgdaFunction{𝒚}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{〉}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaFunction{∨}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{𝑜𝑑𝑑〈}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑣𝑎𝑙}\AgdaSpace{}%
\AgdaFunction{𝒚}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{〉}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{)}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[7]\AgdaOperator{\AgdaInductiveConstructor{𝒹ℴ}}%
\>[148I]\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{𝔦𝔣}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{𝑒𝑣𝑒𝑛〈}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑣𝑎𝑙}\AgdaSpace{}%
\AgdaFunction{𝒚}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{〉}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[148I]%
\>[10]\AgdaOperator{\AgdaInductiveConstructor{𝔱𝔥𝔢𝔫}}\AgdaSpace{}%
\AgdaSymbol{(}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaFunction{𝒚}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{:=}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑣𝑎𝑙}\AgdaSpace{}%
\AgdaFunction{𝒚}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑐𝑜𝑛𝑠𝑡}\AgdaSpace{}%
\AgdaFunction{②}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{;}}\<%
\\
%
\>[13]\AgdaFunction{𝒙}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{:=}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑣𝑎𝑙}\AgdaSpace{}%
\AgdaFunction{𝒙}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑣𝑎𝑙}\AgdaSpace{}%
\AgdaFunction{𝒙}%
\>[35]\AgdaOperator{\AgdaInductiveConstructor{;}}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaInductiveConstructor{𝔢𝔩𝔰𝔢}}\AgdaSpace{}%
\AgdaSymbol{(}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaFunction{𝒚}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{:=}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑣𝑎𝑙}\AgdaSpace{}%
\AgdaFunction{𝒚}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{-}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑐𝑜𝑛𝑠𝑡}\AgdaSpace{}%
\AgdaFunction{①}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{;}}\<%
\\
%
\>[13]\AgdaFunction{𝒛}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{:=}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑣𝑎𝑙}\AgdaSpace{}%
\AgdaFunction{𝒛}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
\AgdaInductiveConstructor{𝑣𝑎𝑙}\AgdaSpace{}%
\AgdaFunction{𝒙}%
\>[35]\AgdaOperator{\AgdaInductiveConstructor{;}}\AgdaSymbol{)}%
\>[41]\AgdaOperator{\AgdaInductiveConstructor{;}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaOperator{\AgdaInductiveConstructor{;}}\<%
\\  
\end{code}